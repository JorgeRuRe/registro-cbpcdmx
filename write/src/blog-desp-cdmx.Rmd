---
title: "Desaparecer en la capital: Lo que sabemos sobre las personas desaparecidas en la Ciudad de México"
author: "Jorge Ruiz Reyes"
date: "11/25/2021"
output: word_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, 
                      message = FALSE,
                      warning = FALSE,
                      cache = FALSE,
                      fig.pos = 'ht'
                     )
```


```{r, echo=FALSE, include=FALSE, warning=FALSE, comment=FALSE}
# Paquetes ----------------------------------------------------------------
if(!require('pacman')) {install.packages('pacman')}
pacman::p_load(tidyverse, sf, here, readxl, janitor)
```


```{r, echo=FALSE, include=FALSE, warning=FALSE, comment=FALSE}
# Files -------------------------------------------------------------------
files <- list(registro_cbpcdmx_clean = here("import", "output", "registro_cdmx_clean.rds"),
              shp_cdmx = here("descriptives", "input", "09mun.shp"),
              rnpdno_clean = here("descriptives-rnpdno", "input", "BASE-DE-DATOS-Personas-desaparecidas-2011-2020.xlsx"),
              proyecciones_conapo = here("descriptives", "input", "base_municipios_final_datos_01.csv"),
              casos_registrados = here("descriptives", "output", "casos_registrados.png"),
              perfiles_desp = here("descriptives", "output", "perfiles_desp.png"),
              perfiles_desp_estatus = here("descriptives", "output", "perfiles_desp_estatus.png"),
              tree_map_escolaridad = here("descriptives", "output", "escolaridad_desp.png"),
              tree_map_civil = here("descriptives", "output", "civil_desp.png"),
              mapa_desp_totales = here("descriptives", "output", "mapa_desp_totales.png"),
              mapa_desp_tasas = here("descriptives", "output", "mapa_desp_tasas.png"),
              lugar_localizacion = here("descriptives", "output", "lugar_localizacion.png"),
              perfiles_desp_cnb = here("descriptives-rnpdno", "output", "perfiles_desp_cnb.png"),
               perfiles_estatus_cnb = here("descriptives-rnpdno", "output", "perfiles_desp_cnb.png"))
```


```{r, echo=FALSE, include=FALSE, warning=FALSE, comment=FALSE}
# Datos 
registro_cbpcdmx_clean <- read_rds(files$registro_cbpcdmx_clean)
shp_cdmx <- st_read(files$shp_cdmx)
rnpdno_clean <- read_excel(files$rnpdno_clean) %>% 
      clean_names()
poblacion_conapo <- read_csv(files$proyecciones_conapo) %>% 
   filter(NOM_ENT == "Ciudad de MÈxico") %>% 
   filter(`A—O` == 2021) %>% 
   group_by(CLAVE_ENT, MUN, `A—O`) %>% 
   summarise(total_poblacion = sum(POB)) %>% 
   ungroup() %>% 
   mutate(
      CVEGEO = case_when(
         MUN == "¡lvaro ObregÛn" ~ "09010", 
         MUN == "Azcapotzalco" ~ "09002", 
         MUN == "Benito Ju·rez" ~ "09014", 
         MUN == "Coyoac·n" ~ "09003", 
         MUN == "Cuajimalpa de Morelos" ~ "09004", 
         MUN == "CuauhtÈmoc" ~ "09015", 
         MUN == "Gustavo A. Madero" ~ "09005", 
         MUN == "Iztacalco" ~ "09006", 
         MUN == "Iztapalapa" ~ "09007", 
         MUN == "La Magdalena Contreras" ~ "09008", 
         MUN == "Miguel Hidalgo" ~ "09016", 
         MUN == "Milpa Alta" ~ "09009", 
         MUN == "Tlalpan" ~ "09012", 
         MUN == "Tl·huac" ~ "09011", 
         MUN == "Venustiano Carranza" ~ "09017", 
         MUN == "Xochimilco" ~ "09013", 
      ))
```


# Introducción 

En México el fenómeno de las desapariciones ya es bien conocido, no obstante a veces parece que es algo que ocurre fuera de la capital. Eso no es cierto. El primer caso de desaparición registrado por las autoridades en la CDMX tiene fecha del año de 1966. Asimismo, los hechos han alcanzado una magnitud mayor en años recientes.  

Ante esto, han existido diversos esfuerzos por atender y visibilizar la problemática. A mediados del año de 2019 el gobierno de la CDMX anunció la creación de la Comisión de Búsqueda de Personas de la CDMX (CBPCDMX), la cual tiene el objetivo de ejecutar y dar seguimiento a las acciones de búsqueda de Personas Desaparecidas en la CDMX. Asimismo, en diciembre de 2019 se publicó la _Ley de Búsqueda de Personas de la CDMX (LBPCDMX)_, la cual establece las acciones y facultades para la búsqueda, investigación e identificación de las autoridades encargadas de atender la problemática. De igual forma, a mediados del año 2021 iniciaron las sesiones y conformación de los grupos de trabajo de las 14 autoridades que conforman el sistema de búsqueda de personas en la entidad. 

Sin embargo, familias de personas desaparecidas y sociedad civil han señalado que las acciones de búsqueda e investigación han sido insuficientes en la entidad por factores como la falta de coordinación entre las autoridades, la propia complejidad geográfica de la ciudad, la falta de visibilización de los casos ante otros fenómenos sociales y políticos y la ausencia de planeación y diagnósticos por parte de las autoridades. Específicamente,frente a la falta de datos para conocer las zonas con mayor incidencia, periodos y perfiles de las personas desaparecidas. 

Teniendo en cuenta lo anterior, este artículo realizará una primera aproximación al fenómeno de la desaparición en la CDMX analizando el Registro de Personas Desaparecidas de la Comisión de Búsqueda de Personas de la CDMX. Es necesario recalcar desde un inicio que frente a las limitaciones de los datos, no se está dando un panorama completo de la desaparición, ni de los patrones específicos de los hechos. Por el contrario, solo se están dando a conocer los patrones de generación de información de una sola fuente que solo puede observar una fracción del fenómeno en su totalidad.          

A continuación se presenta una discusión detallada sobre cómo surge este registro, así como de sus alcances y limitaciones. 


# Contexto de los datos del Registro de Personas Desaparecidas de la Comisión de Búsqueda de Personas de la CDMX


```{r, echo=FALSE, include=FALSE, warning=FALSE, comment=FALSE}
# inline code 
total_casos <- registro_cbpcdmx_clean %>% distinct(id) %>% nrow

per_origen_noticia <- registro_cbpcdmx_clean %>% 
      group_by(fuente_de_reporte) %>% 
      summarize(total=n()) %>% 
      mutate(den=sum(total)) %>% 
      ungroup() %>%
      mutate(per=round((total/den)*100, 1)) %>% 
      filter(fuente_de_reporte == "noticia") %>% 
      select(per)

per_origen_reporte <- registro_cbpcdmx_clean %>% 
      group_by(fuente_de_reporte) %>% 
      summarize(total=n()) %>% 
      mutate(den=sum(total)) %>% 
      ungroup() %>%
      mutate(per=round((total/den)*100, 1)) %>% 
      filter(fuente_de_reporte == "reporte") %>% 
      select(per)

per_origen_portal <- registro_cbpcdmx_clean %>% 
      group_by(origen_de_la_noticia) %>% 
      summarize(total=n()) %>% 
      mutate(den=sum(total)) %>% 
      ungroup() %>% 
      mutate(per=round((total/den)*100, 1)) %>% 
      filter(origen_de_la_noticia == "portal comision búsqueda cdmx") %>% 
      select(per)

per_origen_autoridadescdmx <- registro_cbpcdmx_clean %>% 
      group_by(origen_de_la_noticia) %>% 
      summarize(total=n()) %>% 
      mutate(den=sum(total)) %>% 
      ungroup() %>% 
      mutate(per=round((total/den)*100, 1)) %>% 
      filter(origen_de_la_noticia == "autoridades en general") %>% 
      select(per)

per_origen_colectivos <- registro_cbpcdmx_clean %>% 
      group_by(origen_de_la_noticia) %>% 
      summarize(total=n()) %>% 
      mutate(den=sum(total)) %>% 
      ungroup() %>% 
      mutate(per=round((total/den)*100, 1)) %>% 
      filter(origen_de_la_noticia == "colectivos de familiares") %>% 
      select(per)

per_origen_sc <- registro_cbpcdmx_clean %>% 
      group_by(origen_de_la_noticia) %>% 
      summarize(total=n()) %>% 
      mutate(den=sum(total)) %>% 
      ungroup() %>% 
      mutate(per=round((total/den)*100, 1)) %>% 
      filter(origen_de_la_noticia == "sociedad civil y organismos internacionales") %>% 
      select(per)

```

```{r}
# inline code 
localizadas_vida <- registro_cbpcdmx_clean %>% 
      group_by(condicion_localizacion) %>% 
      summarize(total=n()) %>% 
      mutate(den=sum(total)) %>% 
      ungroup() %>%
      mutate(per=round((total/den)*100, 1)) %>% 
      filter(condicion_localizacion == "con vida") %>% 
      select(per)

localizadas_sin_vida <- registro_cbpcdmx_clean %>% 
      group_by(condicion_localizacion) %>% 
      summarize(total=n()) %>% 
      mutate(den=sum(total)) %>% 
      ungroup() %>%
      mutate(per=round((total/den)*100, 1)) %>% 
      filter(condicion_localizacion == "sin vida") %>% 
      select(per)

localizadas_desp <- registro_cbpcdmx_clean %>% 
      group_by(condicion_localizacion) %>% 
      summarize(total=n()) %>% 
      mutate(den=sum(total)) %>% 
      ungroup() %>%
      mutate(per=round((total/den)*100, 1)) %>% 
      filter(condicion_localizacion == "sigue desaparecida") %>% 
      select(per)

suma_localizadas <- registro_cbpcdmx_clean %>% 
      group_by(condicion_localizacion) %>% 
      summarize(total=n()) %>% 
      mutate(den=sum(total)) %>% 
      ungroup() %>% 
      filter(condicion_localizacion != "sigue desaparecida") %>% 
      mutate(sum = sum(total)) %>%
      filter(condicion_localizacion == "con vida") %>% 
      select(sum)

desp_2020 <- registro_cbpcdmx_clean %>% 
      group_by(año_desaparicion) %>% 
      summarize(total=n()) %>% 
      mutate(den=sum(total)) %>% 
      ungroup() %>% 
      mutate(per=round((total/den)*100, 1)) %>% 
      filter(año_desaparicion == 2020) %>% 
      select(per)

desp_2021 <- registro_cbpcdmx_clean %>% 
      group_by(año_desaparicion) %>% 
      summarize(total=n()) %>% 
      mutate(den=sum(total)) %>% 
      ungroup() %>% 
      mutate(per=round((total/den)*100, 1)) %>% 
      filter(año_desaparicion == 2021) %>% 
      select(per)

```


Existen por lo menos cinco fuentes que registran información sobre casos de desaparición en la CDMX a nivel nacional y local. Estos son: 1) los casos de personas desaparecidas observadas dentro del Registro Nacional de Personas Desaparecidas y No localizadas de la Comisión Nacional de Búsqueda de Personas Desaparecidas (CNB); 2) las llamadas de posibles casos reportados a las líneas de LOCATEL; 3) los casos que son monitoreados por el C5 de la CDMX; 4) el registro de personas desaparecidas de la Fiscalía de Investigación y Persecución de los Delitos en Materia de Desaparición Forzada de Personas y la Desaparición Cometida por Particulares y Búsqueda de Personas Desaparecidas de la CDMX (FIPEDE) y 5) el Registro de Personas Desaparecidas de la Comisión de Búsqueda de Personas de la CDMX (CBPCDMX).

La CBPCDMX proporciona una [versión pública](https://comisiondebusqueda.cdmx.gob.mx/CBP/rpd/version-publica) del regstro con 28 campos o variables de los datos que recopila. Esta fue una decisión de la unidad de análisis de contexto de la CBPCDMX por proporcionar datos abiertos a la ciudadanía sobre los hechos. El último corte de información proporcionado corresponde a julio de 2021^[Para este análisis se tomaron los datos del corte de mayo de 2021, ya que algunos campos como las colonias donde se reportaron las desapariciones tuvieron que ser revisadas manualmente ante la falta de homologación de los datos.], por lo que aún estamos a la espera de las actualizaciones recientes de estos datos. 

Para el corte de información analizado, el registro de la CBPCDMX contaba con `r total_casos` casos de personas desaparecidas en la CDMX. De este total, `r localizadas_vida`% de las personas han sido localizadas con vida, `r localizadas_sin_vida`% de las personas han sido localizadas sin vida y `r localizadas_desp`% permanecen como desaparecidas. 

La CBPCDMX cuenta con casos registrados de personas desaparecidas entre los años de 1966-2021. Los años de 2020(`r desp_2020`%) y 2021 (`r desp_2021`%) son los años con la mayor cantidad de observaciones. Sin embargo, esto no indica que son los años donde se han registrado la mayor cantidad de desapariciones en la entidad. Mas bien muestra que son los años donde el personal ha podido registrar la mayor cantidad de datos desde que inició operaciones la institución en el año de 2019. Por lo tanto, conocer el comportamiento de las desapariciones a lo largo de los años en la entidad aún es difícil con base en los datos con los que se cuenta.

El registro de personas desaparecidas de la CBPCDMX se compone de información enviada por las autoridades de la Administración Pública Local y la Fiscalía General de la CDMX, así como de noticias o reportes que recibe directamente la comisión. `r per_origen_noticia`%  de los casos fueron registrados con base en una noticia en algún medio impreso o electrónico que hablaba sobre la desaparición de una persona en la entidad, mientras que `r per_origen_reporte`% de los casos fueron registrados por reportes realizados directamente a la comisión. 

Si desagregamos esta información aún más, se puede constatar que, efectivamente, `r per_origen_portal`% de los casos fueron registrados directamente por personal de la CBPCDMX en su portal de información. La segunda fuente que ha proporcionado mayor información al registro de la CBPCDMX son casos que han observado otras instituciones de la CDMX como las fiscalías especializadas o la comision ejecutiva de atencion a victimas de la ciudad de mexico. Estos corresponden a `r per_origen_autoridadescdmx`% del total de casos. También destaca que del total de casos, solo `r per_origen_colectivos`% corresponden a casos reportados por colectivos de familiares en búsqueda y `r per_origen_sc`% por sociedad civil. Esto podría indicar que pocas personas conocen o tienen acceso a mecanismos para notificar los hechos de la desaparición a la CBPCDMX. 

# En la CDMX desaparecen mujeres y hombres de edades más avanzadas en comparación con lo observado a nivel nacional. 


```{r}
# inline code rnpdno 

# Perfiles nacionales 
perfiles_hombre_uno_rnpdno <- rnpdno_clean %>% 
      mutate(
            grupo_edad = case_when(edad<12 ~ "Menores de 12 años",
                                   edad %in% 12:17 ~ "De 12 a 17 años",
                                   edad %in% 18:23 ~ "De 18 a 23 años",
                                   edad %in% 24:29 ~ "De 24 a 29 años",
                                   edad %in% 30:44 ~ "De 30 a 44 años",
                                   edad %in% 45:59 ~ "De 45 a 59 años",
                                   edad>=60 ~ "60 años o más"),
            grupo_edad = factor(grupo_edad,
                                levels = c("Menores de 12 años",
                                           "De 12 a 17 años",
                                           "De 18 a 23 años",
                                           "De 24 a 29 años",
                                           "De 30 a 44 años",
                                           "De 45 a 59 años",
                                           "60 años o más"))) %>% 
      group_by(condicion_actual_de_las_personas, edad, grupo_edad)  %>% 
      summarise(hombre = sum(hombres, na.rm = T),
                mujer = sum(mujeres, na.rm = T)) %>% 
      ungroup() %>% 
      select(-edad) %>% 
      pivot_longer(cols = -c(condicion_actual_de_las_personas, grupo_edad),
                   names_to = "sexo",
                   values_to = "total") %>% 
      group_by(sexo, grupo_edad) %>%
      summarize(total= sum(total, na.rm = T)) %>%
      mutate(den=sum(total, na.rm=T)) %>%
      ungroup() %>%
      mutate(per=round((total/den)*100, 1)) %>%
      na.omit() %>% 
      filter(grupo_edad == "De 30 a 44 años" & sexo == "hombre") %>% 
      select(per)


grupo_mayoritario_hombre_nacional <- rnpdno_clean %>% 
      mutate(
            grupo_edad = case_when(edad<12 ~ "Menores de 12 años",
                                   edad %in% 12:17 ~ "De 12 a 17 años",
                                   edad %in% 18:23 ~ "De 18 a 23 años",
                                   edad %in% 24:29 ~ "De 24 a 29 años",
                                   edad %in% 30:44 ~ "De 30 a 44 años",
                                   edad %in% 45:59 ~ "De 45 a 59 años",
                                   edad>=60 ~ "60 años o más"),
            grupo_edad = factor(grupo_edad,
                                levels = c("Menores de 12 años",
                                           "De 12 a 17 años",
                                           "De 18 a 23 años",
                                           "De 24 a 29 años",
                                           "De 30 a 44 años",
                                           "De 45 a 59 años",
                                           "60 años o más"))) %>% 
      group_by(condicion_actual_de_las_personas, edad, grupo_edad)  %>% 
      summarise(hombre = sum(hombres, na.rm = T),
                mujer = sum(mujeres, na.rm = T)) %>% 
      ungroup() %>% 
      select(-edad) %>% 
      pivot_longer(cols = -c(condicion_actual_de_las_personas, grupo_edad),
                   names_to = "sexo",
                   values_to = "total") %>% 
      group_by(sexo, grupo_edad) %>%
      summarize(total= sum(total, na.rm = T)) %>%
      mutate(den=sum(total, na.rm=T)) %>%
      ungroup() %>%
      mutate(per=round((total/den)*100, 1)) %>%
      na.omit() %>% 
      filter(grupo_edad == "De 30 a 44 años" | grupo_edad == "De 24 a 29 años") %>%
      filter(sexo == "hombre") %>% 
      select(per) %>% 
      summarise(per_sum = sum(per))


perfiles_mujer_uno_rnpdno <- rnpdno_clean %>% 
      mutate(
            grupo_edad = case_when(edad<12 ~ "Menores de 12 años",
                                   edad %in% 12:17 ~ "De 12 a 17 años",
                                   edad %in% 18:23 ~ "De 18 a 23 años",
                                   edad %in% 24:29 ~ "De 24 a 29 años",
                                   edad %in% 30:44 ~ "De 30 a 44 años",
                                   edad %in% 45:59 ~ "De 45 a 59 años",
                                   edad>=60 ~ "60 años o más"),
            grupo_edad = factor(grupo_edad,
                                levels = c("Menores de 12 años",
                                           "De 12 a 17 años",
                                           "De 18 a 23 años",
                                           "De 24 a 29 años",
                                           "De 30 a 44 años",
                                           "De 45 a 59 años",
                                           "60 años o más"))) %>% 
      group_by(condicion_actual_de_las_personas, edad, grupo_edad)  %>% 
      summarise(hombre = sum(hombres, na.rm = T),
                mujer = sum(mujeres, na.rm = T)) %>% 
      ungroup() %>% 
      select(-edad) %>% 
      pivot_longer(cols = -c(condicion_actual_de_las_personas, grupo_edad),
                   names_to = "sexo",
                   values_to = "total") %>% 
      group_by(sexo, grupo_edad) %>%
      summarize(total= sum(total, na.rm = T)) %>%
      mutate(den=sum(total, na.rm=T)) %>%
      ungroup() %>%
      mutate(per=round((total/den)*100, 1)) %>%
      na.omit() %>% 
      filter(grupo_edad == "De 12 a 17 años" & sexo == "mujer") %>% 
      select(per)

grupo_mayoritario_mujer_nacional <- rnpdno_clean %>% 
      mutate(
            grupo_edad = case_when(edad<12 ~ "Menores de 12 años",
                                   edad %in% 12:17 ~ "De 12 a 17 años",
                                   edad %in% 18:23 ~ "De 18 a 23 años",
                                   edad %in% 24:29 ~ "De 24 a 29 años",
                                   edad %in% 30:44 ~ "De 30 a 44 años",
                                   edad %in% 45:59 ~ "De 45 a 59 años",
                                   edad>=60 ~ "60 años o más"),
            grupo_edad = factor(grupo_edad,
                                levels = c("Menores de 12 años",
                                           "De 12 a 17 años",
                                           "De 18 a 23 años",
                                           "De 24 a 29 años",
                                           "De 30 a 44 años",
                                           "De 45 a 59 años",
                                           "60 años o más"))) %>% 
      group_by(condicion_actual_de_las_personas, edad, grupo_edad)  %>% 
      summarise(hombre = sum(hombres, na.rm = T),
                mujer = sum(mujeres, na.rm = T)) %>% 
      ungroup() %>% 
      select(-edad) %>% 
      pivot_longer(cols = -c(condicion_actual_de_las_personas, grupo_edad),
                   names_to = "sexo",
                   values_to = "total") %>% 
      group_by(sexo, grupo_edad) %>%
      summarize(total= sum(total, na.rm = T)) %>%
      mutate(den=sum(total, na.rm=T)) %>%
      ungroup() %>%
      mutate(per=round((total/den)*100, 1)) %>%
      na.omit() %>% 
      filter(grupo_edad == "De 12 a 17 años" | grupo_edad == "De 18 a 23 años") %>%
      filter(sexo == "mujer") %>% 
      select(per) %>% 
      summarise(per_sum = sum(per))

```



```{r, echo=FALSE, include=FALSE, warning=FALSE, comment=FALSE}
# inline code cbpcdmx 
perfiles_hombre_uno_cdmx <- registro_cbpcdmx_clean %>% 
      mutate(
            grupo_edad = case_when(edad<12 ~ "Menores de 12 años",
                                   edad %in% 12:17 ~ "De 12 a 17 años",
                                   edad %in% 18:23 ~ "De 18 a 23 años",
                                   edad %in% 24:29 ~ "De 24 a 29 años",
                                   edad %in% 30:44 ~ "De 30 a 44 años",
                                   edad %in% 45:59 ~ "De 45 a 59 años",
                                   edad>=60 ~ "60 años o más"),
            grupo_edad = factor(grupo_edad,
                                levels = c("Menores de 12 años",
                                           "De 12 a 17 años",
                                           "De 18 a 23 años",
                                           "De 24 a 29 años",
                                           "De 30 a 44 años",
                                           "De 45 a 59 años",
                                           "60 años o más"))) %>% 
      group_by(sexo, grupo_edad) %>%
      summarize(total=n()) %>%
      mutate(den=sum(total, na.rm=T)) %>%
      ungroup() %>%
      mutate(per=round((total/den)*100, 1)) %>%
      na.omit() %>% 
      filter(grupo_edad == "De 30 a 44 años" & sexo == "hombre") %>% 
      select(per)


grupo_mayoritario_hombre_cdmx <-  registro_cbpcdmx_clean %>%  
      mutate(
            grupo_edad = case_when(edad<12 ~ "Menores de 12 años",
                                   edad %in% 12:17 ~ "De 12 a 17 años",
                                   edad %in% 18:23 ~ "De 18 a 23 años",
                                   edad %in% 24:29 ~ "De 24 a 29 años",
                                   edad %in% 30:44 ~ "De 30 a 44 años",
                                   edad %in% 45:59 ~ "De 45 a 59 años",
                                   edad>=60 ~ "60 años o más"),
            grupo_edad = factor(grupo_edad,
                                levels = c("Menores de 12 años",
                                           "De 12 a 17 años",
                                           "De 18 a 23 años",
                                           "De 24 a 29 años",
                                           "De 30 a 44 años",
                                           "De 45 a 59 años",
                                           "60 años o más"))) %>% 
      group_by(sexo, grupo_edad) %>%
      summarize(total=n()) %>%
      mutate(den=sum(total, na.rm=T)) %>%
      ungroup() %>%
      mutate(per=round((total/den)*100, 1)) %>%
      na.omit() %>% 
      filter(grupo_edad == "De 30 a 44 años" | grupo_edad == "De 45 a 59 años") %>%
      filter(sexo == "hombre") %>% 
      select(per) %>% 
      summarise(per_sum = sum(per))


perfiles_mujer_uno_cdmx <- registro_cbpcdmx_clean %>% 
      mutate(
            grupo_edad = case_when(edad<12 ~ "Menores de 12 años",
                                   edad %in% 12:17 ~ "De 12 a 17 años",
                                   edad %in% 18:23 ~ "De 18 a 23 años",
                                   edad %in% 24:29 ~ "De 24 a 29 años",
                                   edad %in% 30:44 ~ "De 30 a 44 años",
                                   edad %in% 45:59 ~ "De 45 a 59 años",
                                   edad>=60 ~ "60 años o más"),
            grupo_edad = factor(grupo_edad,
                                levels = c("Menores de 12 años",
                                           "De 12 a 17 años",
                                           "De 18 a 23 años",
                                           "De 24 a 29 años",
                                           "De 30 a 44 años",
                                           "De 45 a 59 años",
                                           "60 años o más"))) %>% 
      group_by(sexo, grupo_edad) %>%
      summarize(total=n()) %>%
      mutate(den=sum(total, na.rm=T)) %>%
      ungroup() %>%
      mutate(per=round((total/den)*100, 1)) %>%
      na.omit() %>% 
      filter(grupo_edad == "De 12 a 17 años" & sexo == "mujer") %>% 
      select(per)

grupo_mayoritario_mujer_cdmx <-  registro_cbpcdmx_clean %>%  
      mutate(
            grupo_edad = case_when(edad<12 ~ "Menores de 12 años",
                                   edad %in% 12:17 ~ "De 12 a 17 años",
                                   edad %in% 18:23 ~ "De 18 a 23 años",
                                   edad %in% 24:29 ~ "De 24 a 29 años",
                                   edad %in% 30:44 ~ "De 30 a 44 años",
                                   edad %in% 45:59 ~ "De 45 a 59 años",
                                   edad>=60 ~ "60 años o más"),
            grupo_edad = factor(grupo_edad,
                                levels = c("Menores de 12 años",
                                           "De 12 a 17 años",
                                           "De 18 a 23 años",
                                           "De 24 a 29 años",
                                           "De 30 a 44 años",
                                           "De 45 a 59 años",
                                           "60 años o más"))) %>% 
      group_by(sexo, grupo_edad) %>%
      summarize(total=n()) %>%
      mutate(den=sum(total, na.rm=T)) %>%
      ungroup() %>%
      mutate(per=round((total/den)*100, 1)) %>%
      na.omit() %>% 
      filter(grupo_edad == "De 12 a 17 años" | grupo_edad == "De 30 a 44 años") %>%
      filter(sexo == "mujer") %>% 
      select(per) %>% 
      summarise(per_sum = sum(per))

```


Sin embargo, el registro de la CBPCDMX nos proporciona otros datos como la edad, sexo, estatus de la persona (sigue desaparecida, localizada con vida y localizada sin vida), lugar de la desaparición, estado civil, escolaridad, entre otras que si nos pueden proporcionar mayor información sobre quiénes son las personas desaparecidas en la CDMX.

Iniciando con los perfiles de las personas desaparecidas observadas por la CBPCDMX, podemos observar los siguientes grupos con base a la edad y sexo de las personas. 

```{r, echo=FALSE, out.width = '100%', out.height='100%', fig.show='hold', fig.align="center", fig.cap="Figura 2"}
knitr::include_graphics(files$perfiles_desp)
```

La figura anterior nos muestra los grupos de personas desaparecidas registradas por la CBPCDMX con base en su edad y sexo. Podemos ver que existen diferencias fundamentales y proporciones más altas conforme a ciertos grupos. Para el caso de las personas del sexo masculino, podemos ver que desaparecen con mayor frecuencia aquellos entre las edades de 30 a 44 años (`r perfiles_hombre_uno`%), seguidos del grupo de 45 a 59 años  (`r perfiles_hombre_dos`%). Para las personas del sexo femenino los datos cambian, ya que vemos que el grupo de edad con el mayor porcentaje de casos corresponden a aquellas entre 12 a 17 años de edad (`r perfiles_mujer_uno`%), seguidas del grupo entre 30 a 44 años (`r perfiles_mujer_dos`%). 


Asimismo, si incluimos el estatus de localización de las personas, podemos ver otros patrones respecto a quiénes desaparecen en la CDMX. 

```{r, echo=FALSE, include=FALSE, warning=FALSE, comment=FALSE}
# quiénes son con estatus 
perfiles_estatus_vida_mujer <- registro_cbpcdmx_clean %>% 
      mutate(
            grupo_edad = case_when(edad<12 ~ "Menores de 12 años",
                                   edad %in% 12:17 ~ "De 12 a 17 años",
                                   edad %in% 18:23 ~ "De 18 a 23 años",
                                   edad %in% 24:29 ~ "De 24 a 29 años",
                                   edad %in% 30:44 ~ "De 30 a 44 años",
                                   edad %in% 45:59 ~ "De 45 a 59 años",
                                   edad>=60 ~ "60 años o más"),
            grupo_edad = factor(grupo_edad,
                                levels = c("Menores de 12 años",
                                           "De 12 a 17 años",
                                           "De 18 a 23 años",
                                           "De 24 a 29 años",
                                           "De 30 a 44 años",
                                           "De 45 a 59 años",
                                           "60 años o más")),
            condicion_localizacion = factor(condicion_localizacion,
                                            levels = c("con vida",
                                                       "sin vida",
                                                       "sigue desaparecida"))) %>% 
      group_by(sexo, condicion_localizacion, grupo_edad) %>%
      summarize(total=n()) %>%
      mutate(den=sum(total, na.rm=T)) %>%
      ungroup() %>%
      mutate(per=round((total/den)*100, 1)) %>%
      na.omit() %>% 
      filter(sexo == "mujer" & condicion_localizacion == "con vida" & grupo_edad == "De 12 a 17 años") %>% 
      select(per)


perfiles_estatus_vida_hombre <- registro_cbpcdmx_clean %>% 
      mutate(
            grupo_edad = case_when(edad<12 ~ "Menores de 12 años",
                                   edad %in% 12:17 ~ "De 12 a 17 años",
                                   edad %in% 18:23 ~ "De 18 a 23 años",
                                   edad %in% 24:29 ~ "De 24 a 29 años",
                                   edad %in% 30:44 ~ "De 30 a 44 años",
                                   edad %in% 45:59 ~ "De 45 a 59 años",
                                   edad>=60 ~ "60 años o más"),
            grupo_edad = factor(grupo_edad,
                                levels = c("Menores de 12 años",
                                           "De 12 a 17 años",
                                           "De 18 a 23 años",
                                           "De 24 a 29 años",
                                           "De 30 a 44 años",
                                           "De 45 a 59 años",
                                           "60 años o más")),
            condicion_localizacion = factor(condicion_localizacion,
                                            levels = c("con vida",
                                                       "sin vida",
                                                       "sigue desaparecida"))) %>% 
      group_by(sexo, condicion_localizacion, grupo_edad) %>%
      summarize(total=n()) %>%
      mutate(den=sum(total, na.rm=T)) %>%
      ungroup() %>%
      mutate(per=round((total/den)*100, 1)) %>%
      na.omit() %>% 
      filter(sexo == "hombre" & condicion_localizacion == "con vida" & grupo_edad == "De 30 a 44 años") %>% 
      select(per)



perfiles_estatus_sinvida_hombre <- registro_cbpcdmx_clean %>% 
      mutate(
            grupo_edad = case_when(edad<12 ~ "Menores de 12 años",
                                   edad %in% 12:17 ~ "De 12 a 17 años",
                                   edad %in% 18:23 ~ "De 18 a 23 años",
                                   edad %in% 24:29 ~ "De 24 a 29 años",
                                   edad %in% 30:44 ~ "De 30 a 44 años",
                                   edad %in% 45:59 ~ "De 45 a 59 años",
                                   edad>=60 ~ "60 años o más"),
            grupo_edad = factor(grupo_edad,
                                levels = c("Menores de 12 años",
                                           "De 12 a 17 años",
                                           "De 18 a 23 años",
                                           "De 24 a 29 años",
                                           "De 30 a 44 años",
                                           "De 45 a 59 años",
                                           "60 años o más")),
            condicion_localizacion = factor(condicion_localizacion,
                                            levels = c("con vida",
                                                       "sin vida",
                                                       "sigue desaparecida"))) %>% 
      group_by(sexo, condicion_localizacion, grupo_edad) %>%
      summarize(total=n()) %>%
      mutate(den=sum(total, na.rm=T)) %>%
      ungroup() %>%
      mutate(per=round((total/den)*100, 1)) %>%
      na.omit() %>% 
      filter(sexo == "hombre" & condicion_localizacion == "sin vida" & grupo_edad == "De 30 a 44 años") %>% 
      select(per)


perfiles_estatus_sinvida_mujer <- registro_cbpcdmx_clean %>% 
      mutate(
            grupo_edad = case_when(edad<12 ~ "Menores de 12 años",
                                   edad %in% 12:17 ~ "De 12 a 17 años",
                                   edad %in% 18:23 ~ "De 18 a 23 años",
                                   edad %in% 24:29 ~ "De 24 a 29 años",
                                   edad %in% 30:44 ~ "De 30 a 44 años",
                                   edad %in% 45:59 ~ "De 45 a 59 años",
                                   edad>=60 ~ "60 años o más"),
            grupo_edad = factor(grupo_edad,
                                levels = c("Menores de 12 años",
                                           "De 12 a 17 años",
                                           "De 18 a 23 años",
                                           "De 24 a 29 años",
                                           "De 30 a 44 años",
                                           "De 45 a 59 años",
                                           "60 años o más")),
            condicion_localizacion = factor(condicion_localizacion,
                                            levels = c("con vida",
                                                       "sin vida",
                                                       "sigue desaparecida"))) %>% 
      group_by(sexo, condicion_localizacion, grupo_edad) %>%
      summarize(total=n()) %>%
      mutate(den=sum(total, na.rm=T)) %>%
      ungroup() %>%
      mutate(per=round((total/den)*100, 1)) %>%
      na.omit() %>% 
      filter(sexo == "mujer" & condicion_localizacion == "sin vida" & grupo_edad == "De 45 a 59 años") %>% 
      select(per)

perfiles_estatus_siguedesp_hombre <- registro_cbpcdmx_clean %>% 
      mutate(
            grupo_edad = case_when(edad<12 ~ "Menores de 12 años",
                                   edad %in% 12:17 ~ "De 12 a 17 años",
                                   edad %in% 18:23 ~ "De 18 a 23 años",
                                   edad %in% 24:29 ~ "De 24 a 29 años",
                                   edad %in% 30:44 ~ "De 30 a 44 años",
                                   edad %in% 45:59 ~ "De 45 a 59 años",
                                   edad>=60 ~ "60 años o más"),
            grupo_edad = factor(grupo_edad,
                                levels = c("Menores de 12 años",
                                           "De 12 a 17 años",
                                           "De 18 a 23 años",
                                           "De 24 a 29 años",
                                           "De 30 a 44 años",
                                           "De 45 a 59 años",
                                           "60 años o más")),
            condicion_localizacion = factor(condicion_localizacion,
                                            levels = c("con vida",
                                                       "sin vida",
                                                       "sigue desaparecida"))) %>% 
      group_by(sexo, condicion_localizacion, grupo_edad) %>%
      summarize(total=n()) %>%
      mutate(den=sum(total, na.rm=T)) %>%
      ungroup() %>%
      mutate(per=round((total/den)*100, 1)) %>%
      na.omit() %>% 
      filter(sexo == "hombre" & condicion_localizacion == "sigue desaparecida" & grupo_edad == "De 30 a 44 años") %>% 
      select(per)


perfiles_estatus_siguedesp_mujer <- registro_cbpcdmx_clean %>% 
      mutate(
            grupo_edad = case_when(edad<12 ~ "Menores de 12 años",
                                   edad %in% 12:17 ~ "De 12 a 17 años",
                                   edad %in% 18:23 ~ "De 18 a 23 años",
                                   edad %in% 24:29 ~ "De 24 a 29 años",
                                   edad %in% 30:44 ~ "De 30 a 44 años",
                                   edad %in% 45:59 ~ "De 45 a 59 años",
                                   edad>=60 ~ "60 años o más"),
            grupo_edad = factor(grupo_edad,
                                levels = c("Menores de 12 años",
                                           "De 12 a 17 años",
                                           "De 18 a 23 años",
                                           "De 24 a 29 años",
                                           "De 30 a 44 años",
                                           "De 45 a 59 años",
                                           "60 años o más")),
            condicion_localizacion = factor(condicion_localizacion,
                                            levels = c("con vida",
                                                       "sin vida",
                                                       "sigue desaparecida"))) %>% 
      group_by(sexo, condicion_localizacion, grupo_edad) %>%
      summarize(total=n()) %>%
      mutate(den=sum(total, na.rm=T)) %>%
      ungroup() %>%
      mutate(per=round((total/den)*100, 1)) %>%
      na.omit() %>% 
      filter(sexo == "mujer" & condicion_localizacion == "sigue desaparecida" & grupo_edad == "De 18 a 23 años") %>% 
      select(per)

```



```{r, echo=FALSE, out.width = '100%', out.height='100%', fig.show='hold', fig.align="center", fig.cap="Figura 3"}
knitr::include_graphics(files$perfiles_desp_estatus)
```

Para las personas que son localizadas con vida, las mujeres entre 12 y 17 años (`r perfiles_estatus_vida_mujer`%) y los hombres entre 30 y 44 años (`r perfiles_estatus_vida_hombre`%) son quienes tienen los porcentajes más altos conforme a su sexo. Para las personas que son localizadas sin vida, los hombres entre 30 y 44 años (`r perfiles_estatus_sinvida_hombre`%) y las mujeres entre 45 y 59 años (`r perfiles_estatus_sinvida_mujer`%) son quienes tienen los porcentajes más altos. Asimismo, para las personas que continúan desaparecidas, las personas del sexo masculino entre 30 y 44 años (`r perfiles_estatus_siguedesp_hombre`%) y las mujeres entre 18 y 23 años (`r perfiles_estatus_siguedesp_mujer`%) son quienes tienen los porcentajes más altos respecto a este grupo. 

La CBPCDMX también proporciona otros datos como la escolaridad de las personas. Si tomamos esta variable y la comparamos con el estatus de las personas podemos ver lo siguiente para aquellas cuya información está completa: 

```{r, echo=FALSE, include=FALSE, warning=FALSE, comment=FALSE}
escolaridad_hombres_vida <- registro_cbpcdmx_clean %>% 
   mutate(condicion_localizacion = factor(condicion_localizacion,
                                           levels = c("con vida",
                                                      "sin vida",
                                                      "sigue desaparecida"))) %>% 
   group_by(sexo, condicion_localizacion, escolaridad) %>% 
   summarize(total=n()) %>% 
   na.omit() %>% 
   mutate(den=sum(total, na.rm=T)) %>%
   ungroup() %>%
   mutate(per=round((total/den)*100, 0)) %>% 
      filter(sexo == "hombre" & condicion_localizacion == "con vida" & escolaridad == "secundaria") %>% 
      select(per)

escolaridad_hombres_vida_dos <- registro_cbpcdmx_clean %>% 
   mutate(condicion_localizacion = factor(condicion_localizacion,
                                           levels = c("con vida",
                                                      "sin vida",
                                                      "sigue desaparecida"))) %>% 
   group_by(sexo, condicion_localizacion, escolaridad) %>% 
   summarize(total=n()) %>% 
   na.omit() %>% 
   mutate(den=sum(total, na.rm=T)) %>%
   ungroup() %>%
   mutate(per=round((total/den)*100, 0)) %>% 
      filter(sexo == "hombre" & condicion_localizacion == "con vida" & escolaridad == "preparatoria") %>% 
      select(per)

escolaridad_mujeres_vida <- registro_cbpcdmx_clean %>% 
   mutate(condicion_localizacion = factor(condicion_localizacion,
                                           levels = c("con vida",
                                                      "sin vida",
                                                      "sigue desaparecida"))) %>% 
   group_by(sexo, condicion_localizacion, escolaridad) %>% 
   summarize(total=n()) %>% 
   na.omit() %>% 
   mutate(den=sum(total, na.rm=T)) %>%
   ungroup() %>%
   mutate(per=round((total/den)*100, 0)) %>% 
      filter(sexo == "mujer" & condicion_localizacion == "con vida" & escolaridad == "preparatoria") %>% 
      select(per)


escolaridad_mujeres_vida_dos <- registro_cbpcdmx_clean %>% 
   mutate(condicion_localizacion = factor(condicion_localizacion,
                                           levels = c("con vida",
                                                      "sin vida",
                                                      "sigue desaparecida"))) %>% 
   group_by(sexo, condicion_localizacion, escolaridad) %>% 
   summarize(total=n()) %>% 
   na.omit() %>% 
   mutate(den=sum(total, na.rm=T)) %>%
   ungroup() %>%
   mutate(per=round((total/den)*100, 0)) %>% 
      filter(sexo == "mujer" & condicion_localizacion == "con vida" & escolaridad == "secundaria") %>% 
      select(per)


escolaridad_hombrs_sinvida <- registro_cbpcdmx_clean %>% 
   mutate(condicion_localizacion = factor(condicion_localizacion,
                                           levels = c("con vida",
                                                      "sin vida",
                                                      "sigue desaparecida"))) %>% 
   group_by(sexo, condicion_localizacion, escolaridad) %>% 
   summarize(total=n()) %>% 
   na.omit() %>% 
   mutate(den=sum(total, na.rm=T)) %>%
   ungroup() %>%
   mutate(per=round((total/den)*100, 0)) %>% 
      filter(sexo == "hombre" & condicion_localizacion == "sin vida" & escolaridad == "secundaria") %>% 
      select(per)


escolaridad_hombrs_sinvida_dos <- registro_cbpcdmx_clean %>% 
   mutate(condicion_localizacion = factor(condicion_localizacion,
                                           levels = c("con vida",
                                                      "sin vida",
                                                      "sigue desaparecida"))) %>% 
   group_by(sexo, condicion_localizacion, escolaridad) %>% 
   summarize(total=n()) %>% 
   na.omit() %>% 
   mutate(den=sum(total, na.rm=T)) %>%
   ungroup() %>%
   mutate(per=round((total/den)*100, 0)) %>% 
      filter(sexo == "hombre" & condicion_localizacion == "sin vida" & escolaridad == "licenciatura") %>% 
      select(per)


escolaridad_mujeres_sinvida <- registro_cbpcdmx_clean %>% 
   mutate(condicion_localizacion = factor(condicion_localizacion,
                                           levels = c("con vida",
                                                      "sin vida",
                                                      "sigue desaparecida"))) %>% 
   group_by(sexo, condicion_localizacion, escolaridad) %>% 
   summarize(total=n()) %>% 
   na.omit() %>% 
   mutate(den=sum(total, na.rm=T)) %>%
   ungroup() %>%
   mutate(per=round((total/den)*100, 0)) %>% 
      filter(sexo == "mujer" & condicion_localizacion == "sin vida" & escolaridad == "licenciatura") %>% 
      select(per)


escolaridad_mujeres_sinvida_dos <- registro_cbpcdmx_clean %>% 
   mutate(condicion_localizacion = factor(condicion_localizacion,
                                           levels = c("con vida",
                                                      "sin vida",
                                                      "sigue desaparecida"))) %>% 
   group_by(sexo, condicion_localizacion, escolaridad) %>% 
   summarize(total=n()) %>% 
   na.omit() %>% 
   mutate(den=sum(total, na.rm=T)) %>%
   ungroup() %>%
   mutate(per=round((total/den)*100, 0)) %>% 
      filter(sexo == "mujer" & condicion_localizacion == "sin vida" & escolaridad == "preparatoria") %>% 
      select(per)


escolaridad_hombres_desp <- registro_cbpcdmx_clean %>% 
   mutate(condicion_localizacion = factor(condicion_localizacion,
                                           levels = c("con vida",
                                                      "sin vida",
                                                      "sigue desaparecida"))) %>% 
   group_by(sexo, condicion_localizacion, escolaridad) %>% 
   summarize(total=n()) %>% 
   na.omit() %>% 
   mutate(den=sum(total, na.rm=T)) %>%
   ungroup() %>%
   mutate(per=round((total/den)*100, 0)) %>% 
      filter(sexo == "hombre" & condicion_localizacion == "sigue desaparecida" & escolaridad == "secundaria") %>% 
      select(per)

escolaridad_hombres_desp_dos <- registro_cbpcdmx_clean %>% 
   mutate(condicion_localizacion = factor(condicion_localizacion,
                                           levels = c("con vida",
                                                      "sin vida",
                                                      "sigue desaparecida"))) %>% 
   group_by(sexo, condicion_localizacion, escolaridad) %>% 
   summarize(total=n()) %>% 
   na.omit() %>% 
   mutate(den=sum(total, na.rm=T)) %>%
   ungroup() %>%
   mutate(per=round((total/den)*100, 0)) %>% 
      filter(sexo == "hombre" & condicion_localizacion == "sigue desaparecida" & escolaridad == "primaria") %>% 
      select(per)


escolaridad_mujeres_desp <- registro_cbpcdmx_clean %>% 
   mutate(condicion_localizacion = factor(condicion_localizacion,
                                           levels = c("con vida",
                                                      "sin vida",
                                                      "sigue desaparecida"))) %>% 
   group_by(sexo, condicion_localizacion, escolaridad) %>% 
   summarize(total=n()) %>% 
   na.omit() %>% 
   mutate(den=sum(total, na.rm=T)) %>%
   ungroup() %>%
   mutate(per=round((total/den)*100, 0)) %>% 
      filter(sexo == "mujer" & condicion_localizacion == "sigue desaparecida" & escolaridad == "preparatoria") %>% 
      select(per)

escolaridad_mujeres_desp_dos <- registro_cbpcdmx_clean %>% 
   mutate(condicion_localizacion = factor(condicion_localizacion,
                                           levels = c("con vida",
                                                      "sin vida",
                                                      "sigue desaparecida"))) %>% 
   group_by(sexo, condicion_localizacion, escolaridad) %>% 
   summarize(total=n()) %>% 
   na.omit() %>% 
   mutate(den=sum(total, na.rm=T)) %>%
   ungroup() %>%
   mutate(per=round((total/den)*100, 0)) %>% 
      filter(sexo == "mujer" & condicion_localizacion == "sigue desaparecida" & escolaridad == "secundaria") %>% 
      select(per)

```



```{r, echo=FALSE, out.width = '100%', out.height='100%', fig.show='hold', fig.align="center", fig.cap="Figura 4"}
knitr::include_graphics(files$tree_map_escolaridad)
```

La gráfica nos indica que el grado de escolaridad de secundaria y preparatoria son los que tiene mayor porcentaje respecto a las personas localizadas con vida o que permanecen sin ser localizadas, mientras que el grado de licenciatura y secundaria concentran la mayor cantidad respecto a las personas que son localizadas sin vida. Sin embargo, existen diferencias desagregando por sexo, ya que las mujeres suelen tener un nivel de estudios mayor que los hombres que han desaparecido en la CDMX, sin importar el estatus de localización. 

Para el grupo de personas que han sido localizadas con vida, podemos ver que la mayoría de ellos cuenta con estudios de secundaria o preparatoria. Para los hombres en este grupo, `r escolaridad_hombres_vida`% tienen estudios de secundaria y `r escolaridad_hombres_vida_dos`% cuenta con estudios de preparatoria. Por su parte, para las mujeres en este grupo `r escolaridad_mujeres_vida`% cuentan con estudios de preparatoria y `r escolaridad_mujeres_vida_dos`% de secundaria. 

Para el grupo de personas localizadas sin vida se observan cambios con los otros grupos, ya que el grupo mayoritario son personas con licenciatura, seguidas de personas con secundaria. Desagregando por sexo, `r escolaridad_hombrs_sinvida`%  de los hombres contaban con estudios de secundaria y `r escolaridad_hombrs_sinvida_dos`% contaban con estudios de licenciatura. Para las mujeres vemos diferencias sustanciales, ya que `r escolaridad_mujeres_sinvida`% contaban con estudios de licenciatura y `r escolaridad_mujeres_sinvida_dos`% contaban con estudios de preparatoria. 

Por último, para el grupo de personas que permanecen desaparecidas la mayoría de los casos son personas que tienen estudios de secundaria y preparatoria. Volviendo a desagregar por sexo, `r escolaridad_hombres_desp`% de los hombres cuentan con estudios secundaria y `r escolaridad_hombres_desp_dos`% cuentan con estudios de primaria. Para el caso de las mujeres, `r escolaridad_mujeres_desp`% cuentan con estudios preparatoria y `r escolaridad_mujeres_desp_dos`% cuentan con estudios secundaria. 


# ¿Dónde desaparecen las personas en la CDMX?

```{r, echo=FALSE, include=FALSE, warning=FALSE, comment=FALSE}
# preparar shape con conapo y datos cbpcdmx 
shp_cdmx <- shp_cdmx %>%
   left_join(poblacion_conapo,
             by = c("CVEGEO" = "CVEGEO")) 


cases_per_muni <- registro_cbpcdmx_clean %>%
   group_by(clave_municipio_desp) %>%
   count(clave_municipio_desp) %>% 
   ungroup() %>% 
   mutate(clave_municipio_desp = str_pad(clave_municipio_desp, width = 3, side = "left", pad = "0"))

per_munis <- cases_per_muni %>% 
      na.omit() %>% 
      mutate(tot_denom=(sum(n))) %>% 
  top_n(3, n) %>%
  summarise(n = sum(n),
            tot_denom = mean(tot_denom)) %>% 
  mutate(pct = round((n/tot_denom)*100, 1)) %>% 
  select(pct)

# Datos para mapa
mapa_registro <- shp_cdmx %>%
   left_join(cases_per_muni,
             by = c("CVE_MUN" = "clave_municipio_desp")) %>% 
   mutate(tasa_desp = n*(100000/total_poblacion)) %>% 
   st_transform(mapa_registro, crs = "+proj=longlat +ellps=WGS72 +no_defs")

```


La CBPCDMX también proporciona información sobre el municipio/alcaldía donde ocurrió la desaparición de las personas. El siguiente mapa muestra el total de casos por alcaldía.^[Es importante tomar en cuenta que el registro también incluye casos de personas que desaparecieron en otras entidades del país.] 


```{r, echo=FALSE, out.width = '100%', out.height='100%', fig.show='hold', fig.align="center", fig.cap="Mapa 1"}
knitr::include_graphics(files$mapa_desp_totales)
```

Como se puede observar, las alcaldías de Iztapalapa (221), Cuauhtémoc (160), Gustavo A. Madero (146), Álvaro Obregón (91) y Coyoacán (87) son las cinco alcaldías que concentran la mayor cantidad de casos reportados en la CDMX, con un `r per_munis`% del total de los que se tiene información sobre el lugar de desaparición.

Los datos también podemos desagregarlos por tasas tomando en cuenta la población de las alcaldías, observado lo siguiente.



```{r, echo=FALSE, out.width = '100%', out.height='100%', fig.show='hold', fig.align="center", fig.cap="Mapa 2"}
knitr::include_graphics(files$mapa_desp_tasas)
```

Si tomamos en cuenta las tasas por cada 100 mil habitantes podemos observar diferencias, ya que la alcaldía que concentra la tasa más alta es la Cuauhtémoc (29.12), seguida de Azcapotzalco (18.41), Tláhuac (16.96), Venustiano Carranza (16.88) y Benito Juárez (16.71). 

# ¿Dónde se localizan las personas que son encontradas con vida o sin vida en la CDMX? 

Para las `r suma_localizadas` personas que han sido localizadas con vida o sin vida, el registro de la CBPCDMX nos proporciona información sobre los lugares donde han sido halladas. Estos lugares nos demuestran la complejidad y retos que tienen las autoridades encargadas de realizar la búsqueda de personas desaparecidas, sobre todo por las posibilidades y planeación que tiene que existir respecto a los casos recibidos.

La siguiente gráfica desglosa estas diferencias respecto al estatus de localización. 


```{r, echo=FALSE, out.width = '100%', out.height='100%', fig.show='hold', fig.align="center", fig.cap="Figura 5"}
knitr::include_graphics(files$lugar_localizacion)
```

Respecto a las personas localizadas con vida, podemos ver que existen diferentes lugares donde han sido halladas, siendo en su propio domicilio (38.06%), en un lugar público (15.17%) y en casa de un amigo o familiar (13.58%) los casos que tienen la proporción más alta. A pesar de esto, las clasificaciones pueden resultar ambiguas, sobre todo si no se conoce con mayor detalle las causas de la desaparición, por lo que hay que ser cuidados cuando se ve que una parte importante se localizan en lugares cercanos a ellas como sus hogares o de personas cercanas. 

Respecto a las personas localizadas sin vida, podemos ver que más de la mitad han sido localizadas (52.5%) han sido localizadas en un centro forense. Sin embargo, también se registran otros lugares como sitios públicos, hoteles, fosas clandestinas e, inclusive, en casas de amigos o familiares. 

# Conclusión 

Los datos analizados nos dan un primer acercamiento al fenómeno de la desaparición en la CDMX. A pesar de que el registro de la CBPCDMX cuenta con limitaciones importantes por el número de casos registrados, también nos proporciona un primer acercamiento que nos muestra ciertas patrones. 

Frente a esto, es importante remarcar la importancia de que el resto de las instituciones que generan datos sobre personas desaparecidas en la entidad puedan generar los mecanismos necesarios para el intercambio adecuado de esta información con el objetivo de conocer la magnitud del fenómeno, los perfiles de las personas y poder generar políticas adecuadas de búsqueda, investigación e identificación de personas desaparecidas en la CDMX. 




<!-- done -->